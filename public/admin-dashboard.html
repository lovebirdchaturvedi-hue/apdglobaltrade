<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Admin Login â€“ APD Global Trade</title>
</head>

<body>

<h2>Admin Login</h2>

<input type="email" id="email" placeholder="Admin Email" /><br><br>
<input type="password" id="password" placeholder="Password" /><br><br>

<button id="loginBtn">Login</button>

<p id="msg" style="color:red;"></p>

<script type="module">
import { auth } from "./js/firebase-init.js";
import { signInWithEmailAndPassword, onAuthStateChanged } from
  "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

const email = document.getElementById("email");
const password = document.getElementById("password");
const msg = document.getElementById("msg");

document.getElementById("loginBtn").addEventListener("click", async () => {
  msg.innerText = "";
  try {
    await signInWithEmailAndPassword(auth, email.value, password.value);
  } catch (err) {
    msg.innerText = err.message;
  }
});

onAuthStateChanged(auth, async (user) => {
  if (!user) return;

  const token = await user.getIdTokenResult();

  if (token.claims.role === "admin") {
    window.location.href = "/admin-dashboard.html";
  } else {
    msg.innerText = "You are not an admin";
  }
});
</script>

</body>
</html>
